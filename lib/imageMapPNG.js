'use strict';

var sharp = require('sharp'),
    necessary = require('necessary');

var constants = require('./constants'),
    namesUtilities = require('./utilities/names');

var asynchronousUtilities = necessary.asynchronousUtilities,
    fileSystemUtilities = necessary.fileSystemUtilities,
    whilst = asynchronousUtilities.whilst,
    readDirectory = fileSystemUtilities.readDirectory,
    removeHiddenNames = namesUtilities.removeHiddenNames,
    dimensionFromNames = namesUtilities.dimensionFromNames,
    RED = constants.RED,
    BLUE = constants.BLUE,
    GREEN = constants.GREEN,
    ALPHA = constants.ALPHA,
    CHANNELS = constants.CHANNELS;


function imageMapPNG(names, imageDirectoryPath, overlayImageSize, response) {
  var namesLength = names.length;

  if (namesLength === 0) {
    names = readDirectory(imageDirectoryPath);
  }

  names = removeHiddenNames(names);

  var dimension = dimensionFromNames(names);

  createImageMap(dimension, overlayImageSize, function (imageBuffer) {
    var context = {
      names: names,
      dimension: dimension,
      imageBuffer: imageBuffer,
      overlayImageSize: overlayImageSize,
      imageDirectoryPath: imageDirectoryPath
    };

    whilst(overlayCallback, function () {
      response.writeHead(200, { 'Content-Type': 'image/png; charset=utf-8' });

      var imageBuffer = context.imageBuffer;


      sharp(imageBuffer).pipe(response);
    }, context);
  });
}

module.exports = imageMapPNG;

function createImageMap(dimension, overlayImageSize, callback) {
  var width = dimension * overlayImageSize,
      height = dimension * overlayImageSize,
      alpha = ALPHA,
      channels = CHANNELS,
      r = RED,
      ///
  g = GREEN,
      ///
  b = BLUE,
      ///
  background = {
    r: r,
    g: g,
    b: b,
    alpha: alpha
  },
      options = {
    width: width,
    height: height,
    channels: channels,
    background: background
  },
      create = options,
      ///
  imageMap = sharp({
    create: create
  });

  imageMap.png().toBuffer().then(function (imageBuffer) {
    callback(imageBuffer);
  });
}

function overlayCallback(next, done, context, index) {
  var names = context.names,
      dimension = context.dimension,
      imageBuffer = context.imageBuffer,
      overlayImageSize = context.overlayImageSize,
      imageDirectoryPath = context.imageDirectoryPath,
      namesLength = names.length,
      lastIndex = namesLength - 1;


  if (index > lastIndex) {
    done();

    return;
  }

  var name = names[index],
      path = imageDirectoryPath + '/' + name;

  resizeImage(path, overlayImageSize, function (resizedImageBuffer) {
    var top = (dimension - 1 - Math.floor(index / dimension)) * overlayImageSize,
        left = index % dimension * overlayImageSize,
        options = {
      top: top,
      left: left
    };

    sharp(imageBuffer).overlayWith(resizedImageBuffer, options).toBuffer().then(function (imageBuffer) {
      Object.assign(context, {
        imageBuffer: imageBuffer
      });

      next();
    });
  });
}

function resizeImage(path, overlayImageSize, callback) {
  var width = overlayImageSize,
      ///
  height = overlayImageSize; ///

  sharp(path).resize(width, height).toBuffer().then(function (imageBuffer) {
    var resizedImageBuffer = imageBuffer; ///

    callback(resizedImageBuffer);
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL2VzNi9pbWFnZU1hcFBORy5qcyJdLCJuYW1lcyI6WyJzaGFycCIsInJlcXVpcmUiLCJuZWNlc3NhcnkiLCJjb25zdGFudHMiLCJuYW1lc1V0aWxpdGllcyIsImFzeW5jaHJvbm91c1V0aWxpdGllcyIsImZpbGVTeXN0ZW1VdGlsaXRpZXMiLCJ3aGlsc3QiLCJyZWFkRGlyZWN0b3J5IiwicmVtb3ZlSGlkZGVuTmFtZXMiLCJkaW1lbnNpb25Gcm9tTmFtZXMiLCJSRUQiLCJCTFVFIiwiR1JFRU4iLCJBTFBIQSIsIkNIQU5ORUxTIiwiaW1hZ2VNYXBQTkciLCJuYW1lcyIsImltYWdlRGlyZWN0b3J5UGF0aCIsIm92ZXJsYXlJbWFnZVNpemUiLCJyZXNwb25zZSIsIm5hbWVzTGVuZ3RoIiwibGVuZ3RoIiwiZGltZW5zaW9uIiwiY3JlYXRlSW1hZ2VNYXAiLCJpbWFnZUJ1ZmZlciIsImNvbnRleHQiLCJvdmVybGF5Q2FsbGJhY2siLCJ3cml0ZUhlYWQiLCJwaXBlIiwibW9kdWxlIiwiZXhwb3J0cyIsImNhbGxiYWNrIiwid2lkdGgiLCJoZWlnaHQiLCJhbHBoYSIsImNoYW5uZWxzIiwiciIsImciLCJiIiwiYmFja2dyb3VuZCIsIm9wdGlvbnMiLCJjcmVhdGUiLCJpbWFnZU1hcCIsInBuZyIsInRvQnVmZmVyIiwidGhlbiIsIm5leHQiLCJkb25lIiwiaW5kZXgiLCJsYXN0SW5kZXgiLCJuYW1lIiwicGF0aCIsInJlc2l6ZUltYWdlIiwicmVzaXplZEltYWdlQnVmZmVyIiwidG9wIiwiTWF0aCIsImZsb29yIiwibGVmdCIsIm92ZXJsYXlXaXRoIiwiT2JqZWN0IiwiYXNzaWduIiwicmVzaXplIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxJQUFNQSxRQUFRQyxRQUFRLE9BQVIsQ0FBZDtBQUFBLElBQ01DLFlBQVlELFFBQVEsV0FBUixDQURsQjs7QUFHQSxJQUFNRSxZQUFZRixRQUFRLGFBQVIsQ0FBbEI7QUFBQSxJQUNHRyxpQkFBaUJILFFBQVEsbUJBQVIs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LENBQ2M7O0FBRXhDTyxhQUFTc0Isa0JBQVQ7QUFDRCxHQVBIO0FBUUQiLCJmaWxlIjoiaW1hZ2VNYXBQTkcuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IHNoYXJwID0gcmVxdWlyZSgnc2hhcnAnKSxcbiAgICAgIG5lY2Vzc2FyeSA9IHJlcXVpcmUoJ25lY2Vzc2FyeScpO1xuXG5jb25zdCBjb25zdGFudHMgPSByZXF1aXJlKCcuL2NvbnN0YW50cycpLFxuXHRcdFx0bmFtZXNVdGlsaXRpZXMgPSByZXF1aXJlKCcuL3V0aWxpdGllcy9uYW1lcycpO1xuXG5jb25zdCB7IGFzeW5jaHJvbm91c1V0aWxpdGllcywgZmlsZVN5c3RlbVV0aWxpdGllcyB9ID0gbmVjZXNzYXJ5LFxuICAgICAgeyB3aGlsc3QgfSA9IGFzeW5jaHJvbm91c1V0aWxpdGllcyxcbiAgICAgIHsgcmVhZERpcmVjdG9yeSB9ID0gZmlsZVN5c3RlbVV0aWxpdGllcyxcbiAgICAgIHsgcmVtb3ZlSGlkZGVuTmFtZXMsIGRpbWVuc2lvbkZyb21OYW1lcyB9ID0gbmFtZXNVdGlsaXRpZXMsXG5cdFx0XHR7IFJFRCwgQkxVRSwgR1JFRU4sIEFMUEhBLCBDSEFOTkVMUyB9ID0gY29uc3RhbnRzO1xuXG5mdW5jdGlvbiBpbWFnZU1hcFBORyhuYW1lcywgaW1hZ2VEaXJlY3RvcnlQYXRoLCBvdmVybGF5SW1hZ2VTaXplLCByZXNwb25zZSkge1xuXHRjb25zdCBuYW1lc0xlbmd0aCA9IG5hbWVzLmxlbmd0aDtcblxuXHRpZiAobmFtZXNMZW5ndGggPT09IDApIHtcblx0XHRuYW1lcyA9IHJlYWREaXJlY3RvcnkoaW1hZ2VEaXJlY3RvcnlQYXRoKTtcblx0fVxuXG5cdG5hbWVzID0gcmVtb3ZlSGlkZGVuTmFtZXMobmFtZXMpO1xuXG5cdGNvbnN0IGRpbWVuc2lvbiA9IGRpbWVuc2lvbkZyb21OYW1lcyhuYW1lcyk7XG5cblx0Y3JlYXRlSW1hZ2VNYXAoZGltZW5zaW9uLCBvdmVybGF5SW1hZ2VTaXplLCBmdW5jdGlvbihpbWFnZUJ1ZmZlcikge1xuICAgIGNvbnN0IGNvbnRleHQgPSB7XG4gICAgICBuYW1lcyxcbiAgICAgIGRpbWVuc2lvbixcbiAgICAgIGltYWdlQnVmZmVyLFxuICAgICAgb3ZlcmxheUltYWdlU2l6ZSxcbiAgICAgIGltYWdlRGlyZWN0b3J5UGF0aFxuICAgIH07XG4gICAgXG4gICAgd2hpbHN0KG92ZXJsYXlDYWxsYmFjaywgZnVuY3Rpb24oKSB7XG4gICAgICByZXNwb25zZS53cml0ZUhlYWQoMjAwLCB7J0NvbnRlbnQtVHlwZSc6ICdpbWFnZS9wbmc7IGNoYXJzZXQ9dXRmLTgnfSk7XG5cbiAgICAgIGNvbnN0IHsgaW1hZ2VCdWZmZXIgfSA9IGNvbnRleHQ7XG5cbiAgICAgIHNoYXJwKGltYWdlQnVmZmVyKS5waXBlKHJlc3BvbnNlKTtcbiAgICB9LCBjb250ZXh0KTtcbiAgfSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaW1hZ2VNYXBQTkc7XG5cbmZ1bmN0aW9uIGNyZWF0ZUltYWdlTWFwKGRpbWVuc2lvbiwgb3ZlcmxheUltYWdlU2l6ZSwgIGNhbGxiYWNrKSB7XG4gIGNvbnN0IHdpZHRoID0gZGltZW5zaW9uICogb3ZlcmxheUltYWdlU2l6ZSxcbiAgICAgICAgaGVpZ2h0ID0gZGltZW5zaW9uICogb3ZlcmxheUltYWdlU2l6ZSxcblx0XHRcdCAgYWxwaGEgPSBBTFBIQSxcbiAgICAgICAgY2hhbm5lbHMgPSBDSEFOTkVMUyxcblx0XHRcdCAgciA9IFJFRCxcdC8vL1xuXHRcdFx0ICBnID0gR1JFRU4sXHQvLy9cblx0XHRcdCAgYiA9IEJMVUUsXHQvLy9cbiAgICAgICAgYmFja2dyb3VuZCA9IHtcbiAgXHQgICAgICByLFxuXHQgICAgICAgIGcsXG5cdCAgICAgICAgYixcblx0ICAgICAgICBhbHBoYVxuICAgICAgICB9LFxuICAgICAgICBvcHRpb25zID0ge1xuICAgICAgICAgIHdpZHRoLFxuICAgICAgICAgIGhlaWdodCxcbiAgICAgICAgICBjaGFubmVscyxcbiAgICAgICAgICBiYWNrZ3JvdW5kXG4gICAgICAgIH0sXG5cdFx0XHQgIGNyZWF0ZSA9IG9wdGlvbnMsIC8vL1xuICAgICAgICBpbWFnZU1hcCA9IHNoYXJwKHtcbiAgICAgICAgICBjcmVhdGVcbiAgICAgICAgfSk7XG5cbiAgaW1hZ2VNYXBcbiAgICAucG5nKClcbiAgICAudG9CdWZmZXIoKVxuICAgIC50aGVuKGZ1bmN0aW9uKGltYWdlQnVmZmVyKSB7XG4gICAgICBjYWxsYmFjayhpbWFnZUJ1ZmZlcilcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gb3ZlcmxheUNhbGxiYWNrKG5leHQsIGRvbmUsIGNvbnRleHQsIGluZGV4KSB7XG4gIGNvbnN0IHsgbmFtZXMsIGRpbWVuc2lvbiwgaW1hZ2VCdWZmZXIsIG92ZXJsYXlJbWFnZVNpemUsIGltYWdlRGlyZWN0b3J5UGF0aCB9ID0gY29udGV4dCxcbiAgICAgICAgbmFtZXNMZW5ndGggPSBuYW1lcy5sZW5ndGgsXG4gICAgICAgIGxhc3RJbmRleCA9IG5hbWVzTGVuZ3RoIC0gMTtcblxuICBpZiAoaW5kZXggPiBsYXN0SW5kZXgpIHtcbiAgICBkb25lKCk7XG4gICAgXG4gICAgcmV0dXJuO1xuICB9XG4gIFxuICBjb25zdCBuYW1lID0gbmFtZXNbaW5kZXhdLFxuICAgICAgICBwYXRoID0gYCR7aW1hZ2VEaXJlY3RvcnlQYXRofS8ke25hbWV9YDtcblxuICByZXNpemVJbWFnZShwYXRoLCBvdmVybGF5SW1hZ2VTaXplLCBmdW5jdGlvbihyZXNpemVkSW1hZ2VCdWZmZXIpIHtcbiAgICBjb25zdCB0b3AgPSAoKGRpbWVuc2lvbiAtIDEpIC0gTWF0aC5mbG9vcihpbmRleCAvIGRpbWVuc2lvbikgKSAqIG92ZXJsYXlJbWFnZVNpemUsXG4gICAgICAgICAgbGVmdCA9IChpbmRleCAlIGRpbWVuc2lvbikgKiBvdmVybGF5SW1hZ2VTaXplLFxuICAgICAgICAgIG9wdGlvbnMgPSB7XG4gICAgICAgICAgICB0b3AsXG4gICAgICAgICAgICBsZWZ0XG4gICAgICAgICAgfTtcblxuICAgIHNoYXJwKGltYWdlQnVmZmVyKVxuICAgICAgLm92ZXJsYXlXaXRoKHJlc2l6ZWRJbWFnZUJ1ZmZlciwgb3B0aW9ucylcbiAgICAgIC50b0J1ZmZlcigpXG4gICAgICAudGhlbihmdW5jdGlvbihpbWFnZUJ1ZmZlcikge1xuICAgICAgICBPYmplY3QuYXNzaWduKGNvbnRleHQsIHtcbiAgICAgICAgICBpbWFnZUJ1ZmZlclxuICAgICAgICB9KTtcblxuICAgICAgICBuZXh0KCk7XG4gICAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHJlc2l6ZUltYWdlKHBhdGgsIG92ZXJsYXlJbWFnZVNpemUsIGNhbGxiYWNrKSB7XG4gIGNvbnN0IHdpZHRoID0gb3ZlcmxheUltYWdlU2l6ZSwgLy8vXG4gICAgICAgIGhlaWdodCA9IG92ZXJsYXlJbWFnZVNpemU7ICAvLy9cbiAgXG4gIHNoYXJwKHBhdGgpXG4gICAgLnJlc2l6ZSh3aWR0aCwgaGVpZ2h0KVxuICAgIC50b0J1ZmZlcigpXG4gICAgLnRoZW4oZnVuY3Rpb24oaW1hZ2VCdWZmZXIpIHtcbiAgICAgIGNvbnN0IHJlc2l6ZWRJbWFnZUJ1ZmZlciA9IGltYWdlQnVmZmVyOyAvLy9cblxuICAgICAgY2FsbGJhY2socmVzaXplZEltYWdlQnVmZmVyKTtcbiAgICB9KTtcbn1cbiJdfQ==